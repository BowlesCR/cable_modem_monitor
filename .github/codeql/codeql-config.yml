name: "CodeQL Security Scanning Configuration"

***REMOVED*** Exclude tools directory from CodeQL scanning
***REMOVED*** Rationale: Tools are diagnostic scripts for local network cable modems that use
***REMOVED*** self-signed certificates. Same security reasoning as documented in const.py:
***REMOVED*** 1. Cable modems universally use self-signed certificates (no CA-signed option)
***REMOVED*** 2. Target environment is private LANs (192.168.x.x, 10.0.x.x)
***REMOVED*** 3. MITM risk acceptable in private network context
***REMOVED*** 4. Self-signed cert still provides encryption in transit
***REMOVED*** 5. These are diagnostic utilities, not production code
paths-ignore:
  - "tools/**"
  - "scripts/**"
  - "docs/**"
  - "tests/parsers/**/fixtures/**"
  - "cable-modem-monitor-ql/**" ***REMOVED*** Exclude development/testing query directory
  - "**/parser_template.py" ***REMOVED*** Template intentionally has commented example code

***REMOVED*** Custom queries are loaded via workflow queries parameter
***REMOVED*** See .github/workflows/codeql.yml line 43

***REMOVED*** Query filters to reduce false positives
query-filters:
  ***REMOVED*** --- Security exclusions (intentional design decisions) ---
  - exclude:
      id: py/clear-text-logging-sensitive-data
      ***REMOVED*** Rationale: Cable modem diagnostics intentionally log configuration
      ***REMOVED*** for troubleshooting. Data is local to Home Assistant instance.
  - exclude:
      id: py/clear-text-storage-sensitive-data
      ***REMOVED*** Rationale: Home Assistant handles credential encryption.
      ***REMOVED*** Integration uses HA's built-in secure storage.
  - exclude:
      id: py/insecure-ssl-config
      ***REMOVED*** Rationale: Cable modems use self-signed certificates on private LANs.
      ***REMOVED*** verify=False is required for connectivity checks in config_flow.py.
      ***REMOVED*** Security justification documented in code comments.
  - exclude:
      id: py/request-without-cert-validation
      ***REMOVED*** Rationale: Cable modems use self-signed certificates on private LANs (192.168.x.x, 10.x.x.x).
      ***REMOVED*** verify=False is required for connectivity checks and data fetching from cable modems.
      ***REMOVED*** This is acceptable because: (1) modems don't offer CA-signed certs, (2) private LAN only,
      ***REMOVED*** (3) MITM risk is acceptable in home network context, (4) encryption still provided.

  ***REMOVED*** --- False positive exclusions (CodeQL limitations) ---
  - exclude:
      id: py/empty-except
      ***REMOVED*** Intentional: har_sanitizer.py uses `except json.JSONDecodeError: pass` for
      ***REMOVED*** graceful degradation. If JSON parsing fails during sanitization, we skip it
      ***REMOVED*** and leave content as-is rather than crashing the sanitizer.
  - exclude:
      id: py/unreachable-statement
      ***REMOVED*** False positive: CodeQL doesn't understand pytest.raises() context manager.
      ***REMOVED*** Code after `with pytest.raises():` IS reachable - the context manager catches
      ***REMOVED*** the exception and continues execution. Standard pytest pattern.
  - exclude:
      id: py/import-and-import-from
      ***REMOVED*** False positive in test files: Tests intentionally use both `import X as module`
      ***REMOVED*** (to access internals like _PARSER_CACHE) and `from X import func` (for clean API).
      ***REMOVED*** This is a valid testing pattern for verifying module-level state.
  - exclude:
      id: py/unused-global-variable
      ***REMOVED*** False positive: CodeQL doesn't track `global` statement properly.
      ***REMOVED*** parsers/__init__.py declares `global _PARSER_CACHE` before assignment.
      ***REMOVED*** The variable IS used on subsequent function calls for caching.
  - exclude:
      id: py/commented-out-code
      ***REMOVED*** Handled via paths-ignore for parser_template.py (intentional examples).
      ***REMOVED*** Other instances are format documentation like "***REMOVED*** cells[0] = Channel number"
      ***REMOVED*** which are column mappings, not dead code.

***REMOVED*** Enable all security-related query metadata
***REMOVED*** This ensures comprehensive coverage of CWE categories
disable-default-queries: false
